基于机器学习的贫血智能诊断系统
Machine Learning Based Intelligent Anemia Diagnosis System

项目背景与意义
研究背景
- 贫血是常见的血液疾病，全球影响超过20亿人
- 早期准确诊断对治疗和预后至关重要
- 传统诊断依赖专家经验，耗时且存在主观性

研究意义
- 提高诊断效率：辅助医生快速判断贫血类型
- 降低误诊率：基于大数据的客观分析
- 普及医疗知识：为基层医疗提供智能诊断工具

技术路线
机器学习 + 医疗数据 = 智能诊断模型

数据集介绍
数据来源
- 土耳其托卡特加齐奥斯曼帕萨大学医学院（真实临床数据）
- 时间跨度：2013-2018年（5年）
- 样本数量：15,300名患者

数据特征
- 24个血液检测指标
- 完整血常规（CBC）结果
- 血清铁、维生素B12、叶酸等关键指标

分类任务
五分类问题：
- Class 0: 无贫血 (64%, 9,747例)
- Class 1: HGB贫血 (7%, 1,019例)
- Class 2: 缺铁性贫血 (27%, 4,182例)
- Class 3: 叶酸缺乏贫血 (1%, 153例)
- Class 4: 维生素B12缺乏贫血 (1%, 199例)

数据预处理
数据清洗
- 删除重复值：88条重复记录
- 处理缺失值：剔除不完整记录
- 异常值检测：根据医学参考范围识别
- 最终数据规模：14,212条高质量记录

数据变换
- Min-Max归一化：将所有特征缩放到[0,1]区间
- 类别编码：标签映射到0-4
- 数据集划分：训练集80% + 测试集20%（分层抽样）

数据挑战
- 严重不平衡：比例达657:1
- 少数类样本稀缺：叶酸和B12缺乏仅200例左右
- 采用类别权重平衡策略

特征工程
特征列表（24维）
- 基础信息：性别
- 白细胞系统：WBC, NE#, LY#, MO#, EO#, BA#
- 红细胞系统：RBC, HGB, HCT, MCV, MCH, MCHC, RDW
- 血小板系统：PLT, MPV, PCT, PDW
- 血清铁指标：SD, SDTSD, TSD
- 生化指标：FERRITTE铁蛋白, FOLATE叶酸, B12

与目标变量的相关性
- 第1名：B12_Anemia_class（相关系数0.52）
- 第2名：HGB（相关系数-0.38）
- 第3名：HCT（相关系数-0.36）
- 第4名：RBC（相关系数-0.35）
- 第5名：Folate_anemia_class（相关系数0.20）

特征分布特点
- 高度相关：HGB与HCT（r=0.95）
- 弱相关性：大多数特征间相关性小于0.4
- 符合预期：没有冗余特征

建模方法
评估指标
- 准确率Accuracy：整体预测正确率
- Macro F1：各类别平均（处理不平衡数据）
- 加权F1：考虑样本权重的F1

算法选择
评估6种经典机器学习算法：

传统方法
- 逻辑回归：线性模型 + 类别权重平衡
- 支持向量机SVM：RBF核 + 类别权重平衡

树模型
- 决策树：自动特征选择 + 可解释性强
- 随机森林：集成学习 + 抗过拟合
- 梯度提升GBDT：逐步优化 + 高准确率

实例方法
- K近邻KNN：距离加权 + 非参数模型

实验结果
模型性能对比
- 第1名：决策树（Accuracy=99.88%，Macro F1=99.74%）
- 第2名：梯度提升（Accuracy=99.88%，Macro F1=99.74%）
- 第3名：随机森林（Accuracy=96.86%，Macro F1=88.53%）
- 第4名：K近邻（Accuracy=93.71%，Macro F1=70.43%）
- 第5名：逻辑回归（Accuracy=92.55%，Macro F1=82.86%）
- 第6名：SVM（Accuracy=92.90%，Macro F1=81.32%）

关键发现
- 决策树和梯度提升并列最佳
- 6种算法中4种准确率大于93%
- 树模型整体优于线性模型
- 有效处理不平衡数据

混淆矩阵分析
决策树模型混淆矩阵
- 无贫血：789例正确，100%召回率
- HGB贫血：23例正确，100%召回率
- 缺铁性贫血：40例正确，97.6%召回率
- 叶酸缺乏：1例正确，100%召回率
- B12缺乏：5例正确，100%召回率

分类报告（决策树）
- 准确率：99.88%
- Macro F1：99.74%
- 加权F1：99.88%
- 支持度：859个测试样本

特征重要性分析
Top 10 重要特征
- 第1名：B12_Anemia_class，重要性25.0%，B12缺乏关键指标
- 第2名：Folate_anemia_class，重要性25.0%，叶酸缺乏关键指标
- 第3名：HGB，重要性21.9%，血红蛋白，贫血核心指标
- 第4名：TSD，重要性18.6%，铁传递饱和度
- 第5名：GENDER，重要性4.9%，性别差异影响
- 第6名：FERRITTE，重要性4.2%，铁蛋白，铁储备
- 第7名：B12，重要性0.5%，维生素B12水平

分析结论
- B12和叶酸相关指标最重要，与贫血类型直接相关
- 血红蛋白（HGB）是核心诊断指标，符合临床诊断逻辑
- 铁代谢指标（TSD、FERRITTE）对缺铁性贫血诊断关键

技术亮点
1. 数据预处理优化
- 基于医学知识的异常值检测
- 严格的清洗流程确保数据质量
- 归一化处理提高模型稳定性

2. 不平衡数据处理
- 类别权重平衡：自动调整少数类权重
- 合适的评估指标：使用Macro F1而非Accuracy
- 分层抽样：确保训练/测试集分布一致

3. 可解释性设计
- 决策树模型：提供明确的诊断规则
- 特征重要性：识别关键医疗指标
- 临床一致性：重要特征符合医学常识

4. 模型鲁棒性
- 5折交叉验证：充分评估模型稳定性
- 多种算法对比：避免单一模型偏见
- 独立测试集：保证评估结果的客观性

项目成果与价值
定量成果
- 准确率：99.88%（几乎完美）
- Macro F1：99.74%（处理不平衡的优秀指标）
- 效率提升：秒级诊断 vs 传统分钟级诊断

技术创新
- 基于真实临床数据：15,300例患者记录
- 5分类诊断系统：不仅能判断是否贫血，还能准确区分贫血类型
- 高准确率：在独立测试集上达到99%+的准确率
- 可解释性强：决策树模型提供了清晰的诊断规则

实际应用价值
- 辅助医生决策：提供第二意见，降低误诊率
- 提高诊断效率：从分钟级缩短到秒级
- 医学教育培训：作为机器学习+医疗的教学案例
- 基层医疗支持：部署到资源有限地区
- 远程医疗诊断：集成到远程诊疗系统

局限性与改进方向
现存局限
- 样本清洗：删除约7%的原始数据，可能影响泛化
- 少数类样本不足：叶酸和B12缺乏样本量偏少
- 数据泄露风险：部分特征可能与标签有隐含关联

短期改进计划（1-2个月）
- 超参数调优：使用GridSearchCV/RandomizedSearchCV
- 先进算法：尝试XGBoost、LightGBM
- 过采样技术：使用SMOTE增加少数类样本
- 交叉验证优化：从5折增加到10折

长期规划（6-12个月）
- 数据扩充：收集更多少数类样本
- 深度学习：探索神经网络模型
- 模型集成：融合多个最佳模型
- 云端部署：提供API服务，在线诊断
- 持续优化：收集用户反馈，定期更新模型

总结与未来展望
核心结论
- 机器学习可有效诊断贫血类型
- 决策树和梯度提升表现最优
- 模型性能接近临床应用标准
- 特征选择与医学诊断逻辑一致

临床意义
- 辅助医生诊断：提供客观的、基于大数据的第二意见
- 提高效率：从传统10-15分钟缩短到1-2秒
- 降低误诊：基于15,000+真实案例训练，比仅靠经验更准确
- 普及医疗：让基层医疗机构也能获得专家级诊断能力

未来展望
- 多模态融合：结合影像数据、基因数据
- 实时诊断系统：集成到现有医疗设备
- 个性化治疗：基于诊断结果推荐治疗方案
- 预防医学：早期筛查和风险预测
- 扩展应用：高血压、糖尿病等其他慢性病

致谢
数据来源
- 土耳其托卡特加齐奥斯曼帕萨大学医学院
- 论文参考：
  Kilicarslan, S., Celik, M., & Sahin, Ş. (2021).
  Hybrid models based on genetic algorithm and deep learning
  algorithms for nutritional Anemia disease classification.
  Biomedical Signal Processing and Control, 63, 102231.

技术栈
- 编程语言：Python 3.x
- 机器学习：scikit-learn
- 数据处理：pandas, numpy
- 可视化：matplotlib, seaborn
- 报告生成：Markdown + PPT Generator

课程信息
- 课程名称：机器学习课程设计
- 课题类型：多分类问题
- 应用领域：医疗诊断
- 完成时间：2025年11月

Q&A
感谢您的聆听！

项目联系方式
- Email: your-email@example.com
- GitHub: github.com/your-username
- 数据集: 15,300真实患者记录

演示代码
# 运行完整流程
cd 机器学习大作业
python 1_数据探索.py
python 2_数据清洗和特征工程.py
python 3_建模和评估.py
python 4_生成报告.py

欢迎大家提问交流！
---
END
